{"ast":null,"code":"var _jsxFileName = \"D:\\\\siteauth\\\\my-website \\u2014 \\u043A\\u043E\\u043F\\u0438\\u044F\\\\src\\\\components\\\\game.js\",\n  _s = $RefreshSig$();\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport GameControls from './game-controls';\nimport Map from './map';\nimport { shuffleArray } from '../logic/utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GameContainer = styled.div`\n  display: flex;\n  gap: 10px;\n  padding: 10px;\n\n  // height fix\n  height: calc(100% - 20px);\n`;\n_c = GameContainer;\nconst CaptureModalBackdrop = styled.div`\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.6);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n`;\n_c2 = CaptureModalBackdrop;\nconst CaptureModalCard = styled.div`\n  background: #ffffff;\n  border-radius: 16px;\n  padding: 24px 24px 72px;\n  width: 95%;\n  max-width: 1100px;\n  height: 80vh;\n  box-shadow: 0 24px 80px rgba(0, 0, 0, 0.5);\n  display: flex;\n  flex-direction: column;\n  position: relative;\n`;\n_c3 = CaptureModalCard;\nconst CaptureModalImagePlaceholder = styled.div`\n  width: 100%;\n  height: 80px;\n  border-radius: 8px;\n  background: #f2f2f2;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #777;\n  font-size: 14px;\n  margin-top: 8px;\n  margin-bottom: 16px;\n`;\n_c4 = CaptureModalImagePlaceholder;\nconst CaptureModalTitle = styled.h2`\n  margin: 0 0 8px;\n  font-size: 20px;\n`;\n_c5 = CaptureModalTitle;\nconst CaptureModalText = styled.p`\n  margin: 12px 0 20px;\n  font-size: 14px;\n  color: #444;\n`;\n_c6 = CaptureModalText;\nconst CaptureModalActions = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-end;\n  gap: 24px;\n  position: absolute;\n  left: 24px;\n  right: 24px;\n  bottom: 24px;\n`;\n_c7 = CaptureModalActions;\nconst CaptureModalColumn = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n`;\n_c8 = CaptureModalColumn;\nconst CaptureButton = styled.button`\n  padding: 8px 16px;\n  border-radius: 8px;\n  border: none;\n  cursor: pointer;\n  font-size: 14px;\n\n  &.cancel {\n    background: #e5e5e5;\n    color: #222;\n  }\n\n  &.confirm {\n    background: #16a34a;\n    color: #fff;\n  }\n\n  &.confirm-alt {\n    background: #22c55e;\n    color: #fff;\n  }\n\n  &.cancel-alt {\n    background: #f97316;\n    color: #fff;\n  }\n`;\n_c9 = CaptureButton;\nconst shuffleTurnsOrder = arr => arr.concat(arr.splice(0, 1));\nconst availableColors = shuffleArray(['#7975b9', '#007F73', '#FB9AD1', '#FFC470', '#C5FF95', '#4793AF', '#ff7171']);\nconst Game = ({\n  map\n}) => {\n  _s();\n  const [teams, setTeams] = React.useState([]);\n  const [basePositions, setBasePositions] = React.useState([]);\n  const [gameState, setGameState] = React.useState('prepare');\n  const [turnsOrder, setTurnsOrder] = React.useState([]);\n  const [currentTurn, setCurrentTurn] = React.useState(null);\n  const [roundNumber, setRoundNumber] = React.useState(0);\n  const [activeTeam, setActiveTeam] = React.useState(null);\n  const [pendingCaptureZone, setPendingCaptureZone] = React.useState(null);\n  const [captureState, setCaptureState] = React.useState({\n    attackerAnswered: false,\n    defenderAnswered: false,\n    attackerCorrect: null,\n    defenderCorrect: null,\n    firstResponder: null\n  });\n  const setBase = React.useCallback((zoneId, teamIndex) => {\n    const newBasePositions = [...basePositions, zoneId];\n    const newTeams = [...teams];\n    newTeams[teamIndex].base = zoneId;\n    setBasePositions(newBasePositions);\n    setTeams(newTeams);\n  }, [basePositions, teams]);\n  const toggleZoneToTeam = React.useCallback((zoneId, teamIndex) => {\n    let shouldCleanupBase = true;\n    const newTeams = [...teams];\n    if (teams[teamIndex].zones.includes(zoneId)) {\n      newTeams[teamIndex].zones = newTeams[teamIndex].zones.filter(z => z !== zoneId);\n      if (newTeams[teamIndex].base === zoneId) {\n        newTeams[teamIndex].base = null;\n      }\n    } else {\n      // Remove the zone from the previous owner\n      const prevOwner = newTeams.find(team => team.zones.includes(zoneId));\n      if (prevOwner) {\n        prevOwner.zones = prevOwner.zones.filter(z => z !== zoneId);\n      }\n\n      // Set the base if preparing\n      if (gameState === 'prepare' && !newTeams[activeTeam].base) {\n        console.log('set base', zoneId);\n        setBase(zoneId, activeTeam);\n        shouldCleanupBase = false;\n      }\n      newTeams[teamIndex].zones.push(zoneId);\n    }\n\n    // Destroy the base\n    if (shouldCleanupBase) {\n      setBasePositions(basePositions.filter(z => z !== zoneId));\n    }\n    setTeams(newTeams);\n  }, [activeTeam, basePositions, gameState, setBase, teams]);\n  const onTurnComplete = React.useCallback(() => {\n    const nextTeam = turnsOrder.slice(currentTurn + 1).find(teamIndex => teams[teamIndex].zones.length > 0);\n    if (typeof nextTeam !== 'undefined') {\n      setCurrentTurn(currentTurn + 1);\n      setActiveTeam(nextTeam);\n      return;\n    }\n    setRoundNumber(roundNumber + 1);\n    setCurrentTurn(0);\n    const newTurnsOrder = shuffleTurnsOrder([...turnsOrder].map(teamIndex => teams[teamIndex].zones.length > 0 ? teamIndex : undefined).filter(i => typeof i !== 'undefined'));\n    setTurnsOrder(newTurnsOrder);\n    setActiveTeam(newTurnsOrder[0]);\n  }, [currentTurn, roundNumber, teams, turnsOrder]);\n  const onZoneClick = React.useCallback((zoneId, isRightClick) => {\n    if (gameState === 'prepare' && activeTeam !== null) {\n      toggleZoneToTeam(zoneId, activeTeam);\n    }\n    if (gameState === 'started') {\n      const zoneOwner = teams.find(team => team.zones.includes(zoneId));\n      const zoneOwnerId = teams.findIndex(team => team.zones.includes(zoneId));\n      const newTeams = [...teams];\n      if (isRightClick) {\n        if (!zoneOwner || zoneOwnerId === activeTeam) return;\n        if (zoneOwner && zoneOwner.base === zoneId && basePositions.includes(zoneId)) {\n          newTeams[zoneOwnerId].score += 200;\n        } else {\n          newTeams[zoneOwnerId].score += 100;\n        }\n        setTeams(newTeams);\n        onTurnComplete();\n      }\n      if (!isRightClick) {\n        // neutral tile: immediate capture as before\n        if (!zoneOwner) {\n          newTeams[activeTeam].score += 100;\n          toggleZoneToTeam(zoneId, activeTeam);\n          setTeams(newTeams);\n          onTurnComplete();\n          return;\n        }\n\n        // own tile: ignore\n        if (zoneOwnerId === activeTeam) {\n          return;\n        }\n\n        // enemy tile: open confirmation window\n        setPendingCaptureZone(zoneId);\n        setCaptureState({\n          attackerAnswered: false,\n          defenderAnswered: false,\n          attackerCorrect: null,\n          defenderCorrect: null,\n          firstResponder: null\n        });\n      }\n    }\n  }, [activeTeam, basePositions, gameState, onTurnComplete, teams, toggleZoneToTeam]);\n  const cancelCapture = React.useCallback(() => {\n    setPendingCaptureZone(null);\n    setCaptureState({\n      attackerAnswered: false,\n      defenderAnswered: false,\n      attackerCorrect: null,\n      defenderCorrect: null,\n      firstResponder: null\n    });\n  }, []);\n  const maybeResolveCapture = React.useCallback((state, zoneId) => {\n    if (!state.attackerAnswered || !state.defenderAnswered) return;\n    const zoneOwner = teams.find(team => team.zones.includes(zoneId));\n    const zoneOwnerId = teams.findIndex(team => team.zones.includes(zoneId));\n    if (!zoneOwner || zoneOwnerId === -1) {\n      // fallback: no defender, attacker wins on correct\n      return;\n    }\n    let winner = 'defender';\n    if (!state.attackerCorrect && !state.defenderCorrect) {\n      winner = 'defender';\n    } else if (state.attackerCorrect && !state.defenderCorrect) {\n      winner = 'attacker';\n    } else if (!state.attackerCorrect && state.defenderCorrect) {\n      winner = 'defender';\n    } else if (state.attackerCorrect && state.defenderCorrect) {\n      winner = state.firstResponder === 'attacker' ? 'attacker' : 'defender';\n    }\n    const newTeams = [...teams];\n    if (winner === 'attacker' && zoneOwnerId !== activeTeam) {\n      if (zoneOwner.base === zoneId && basePositions.includes(zoneId)) {\n        newTeams[activeTeam].score += 400;\n        newTeams[zoneOwnerId].zones.forEach(zone => toggleZoneToTeam(zone, activeTeam));\n        newTeams[zoneOwnerId].base = null;\n        setBasePositions(basePositions.filter(z => z !== zoneId));\n      } else {\n        newTeams[activeTeam].score += 100;\n        toggleZoneToTeam(zoneId, activeTeam);\n      }\n    }\n    setTeams(newTeams);\n    setPendingCaptureZone(null);\n    setCaptureState({\n      attackerAnswered: false,\n      defenderAnswered: false,\n      attackerCorrect: null,\n      defenderCorrect: null,\n      firstResponder: null\n    });\n    onTurnComplete();\n  }, [activeTeam, basePositions, onTurnComplete, teams, toggleZoneToTeam]);\n  const handleAttackerAnswer = React.useCallback(isCorrect => {\n    if (!pendingCaptureZone) return;\n    setCaptureState(prev => {\n      if (prev.attackerAnswered) return prev;\n      const next = {\n        ...prev,\n        attackerAnswered: true,\n        attackerCorrect: isCorrect,\n        firstResponder: prev.firstResponder || 'attacker'\n      };\n      maybeResolveCapture(next, pendingCaptureZone);\n      return next;\n    });\n  }, [maybeResolveCapture, pendingCaptureZone]);\n  const handleDefenderAnswer = React.useCallback(isCorrect => {\n    if (!pendingCaptureZone) return;\n    setCaptureState(prev => {\n      if (prev.defenderAnswered) return prev;\n      const next = {\n        ...prev,\n        defenderAnswered: true,\n        defenderCorrect: isCorrect,\n        firstResponder: prev.firstResponder || 'defender'\n      };\n      maybeResolveCapture(next, pendingCaptureZone);\n      return next;\n    });\n  }, [maybeResolveCapture, pendingCaptureZone]);\n  const attackerOrderLabel = captureState.firstResponder === 'attacker' ? '1' : captureState.firstResponder === 'defender' && captureState.attackerAnswered ? '2' : '';\n  const defenderOrderLabel = captureState.firstResponder === 'defender' ? '1' : captureState.firstResponder === 'attacker' && captureState.defenderAnswered ? '2' : '';\n  return /*#__PURE__*/_jsxDEV(GameContainer, {\n    children: [/*#__PURE__*/_jsxDEV(Map, {\n      teams: teams,\n      basePositions: basePositions,\n      gameState: gameState,\n      disabledZones: gameState === 'prepare' && activeTeam !== null ? map.getAdjucentZones(teams.filter((_, index) => index !== activeTeam).flatMap(team => team.zones)) : [],\n      onZoneClick: onZoneClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(GameControls, {\n      teams: teams,\n      activeTeam: activeTeam,\n      onTeamAdded: teamName => {\n        setTeams([...teams, {\n          name: teamName,\n          score: 1000,\n          zones: [],\n          color: availableColors.pop()\n        }]);\n      },\n      onTeamClick: teamIndex => {\n        if (gameState === 'prepare') {\n          setActiveTeam(teamIndex === activeTeam ? null : teamIndex);\n        }\n      },\n      onGameStart: () => {\n        setGameState('started');\n        setCurrentTurn(0);\n        setRoundNumber(1);\n        setTurnsOrder(teams.map((tmp, index) => index));\n        setActiveTeam(0);\n      },\n      onTurnComplete: onTurnComplete,\n      gameState: gameState,\n      currentTurn: turnsOrder[currentTurn],\n      roundNumber: roundNumber\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this), pendingCaptureZone && /*#__PURE__*/_jsxDEV(CaptureModalBackdrop, {\n      children: /*#__PURE__*/_jsxDEV(CaptureModalCard, {\n        children: [/*#__PURE__*/_jsxDEV(CaptureModalImagePlaceholder, {\n          children: \"Image placeholder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CaptureModalTitle, {\n          children: [\"\\u0417\\u0430\\u0445\\u0432\\u0430\\u0442\\u0438\\u0442\\u044C \\u0437\\u043E\\u043D\\u0443 \", pendingCaptureZone, \"?\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CaptureModalText, {\n          children: \"\\u0417\\u0434\\u0435\\u0441\\u044C \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u0437\\u0430\\u0434\\u0430\\u043D\\u0438\\u044F \\u0438\\u043B\\u0438 \\u043F\\u043E\\u0434\\u0441\\u043A\\u0430\\u0437\\u043A\\u0430 \\u0434\\u043B\\u044F \\u0438\\u0433\\u0440\\u043E\\u043A\\u0430. \\u041F\\u043E\\u0441\\u043B\\u0435 \\u0432\\u044B\\u043F\\u043E\\u043B\\u043D\\u0435\\u043D\\u0438\\u044F \\u0437\\u0430\\u0434\\u0430\\u043D\\u0438\\u044F \\u0432\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442 \\u0430\\u0442\\u0430\\u043A\\u0438 \\u0434\\u043B\\u044F \\u0430\\u0442\\u0430\\u043A\\u0443\\u044E\\u0449\\u0438\\u0445 \\u0438 \\u0437\\u0430\\u0449\\u0438\\u0449\\u0430\\u044E\\u0449\\u0438\\u0445\\u0441\\u044F.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CaptureModalActions, {\n          children: [/*#__PURE__*/_jsxDEV(CaptureModalColumn, {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: attackerOrderLabel\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CaptureButton, {\n              className: \"confirm\",\n              onClick: () => handleAttackerAnswer(true),\n              children: \"\\u0410\\u0442\\u0430\\u043A\\u0443\\u044E\\u0449\\u0438\\u0435-\\u0432\\u0435\\u0440\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CaptureButton, {\n              className: \"cancel\",\n              onClick: () => handleAttackerAnswer(false),\n              children: \"\\u0410\\u043A\\u0442\\u0430\\u043A\\u0443\\u044E\\u0449\\u0438\\u0435-\\u043D\\u0435\\u0432\\u0435\\u0440\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CaptureModalColumn, {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: defenderOrderLabel\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 444,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CaptureButton, {\n              className: \"confirm-alt\",\n              onClick: () => handleDefenderAnswer(true),\n              children: \"\\u0417\\u0430\\u0449\\u0438\\u0449\\u0430\\u044E\\u0449\\u0438\\u0435\\u0441\\u044F - \\u0432\\u0435\\u0440\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 445,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CaptureButton, {\n              className: \"cancel-alt\",\n              onClick: () => handleDefenderAnswer(false),\n              children: \"\\u0417\\u0430\\u0449\\u0438\\u0449\\u0430\\u044E\\u0449\\u0438\\u0435\\u0441\\u044F- \\u043D\\u0435\\u0432\\u0435\\u0440\\u043D\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 443,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 377,\n    columnNumber: 5\n  }, this);\n};\n_s(Game, \"8vY1/H1i/dctAucojL0Dxn8OqN0=\");\n_c0 = Game;\nexport default Game;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0;\n$RefreshReg$(_c, \"GameContainer\");\n$RefreshReg$(_c2, \"CaptureModalBackdrop\");\n$RefreshReg$(_c3, \"CaptureModalCard\");\n$RefreshReg$(_c4, \"CaptureModalImagePlaceholder\");\n$RefreshReg$(_c5, \"CaptureModalTitle\");\n$RefreshReg$(_c6, \"CaptureModalText\");\n$RefreshReg$(_c7, \"CaptureModalActions\");\n$RefreshReg$(_c8, \"CaptureModalColumn\");\n$RefreshReg$(_c9, \"CaptureButton\");\n$RefreshReg$(_c0, \"Game\");","map":{"version":3,"names":["React","styled","GameControls","Map","shuffleArray","jsxDEV","_jsxDEV","GameContainer","div","_c","CaptureModalBackdrop","_c2","CaptureModalCard","_c3","CaptureModalImagePlaceholder","_c4","CaptureModalTitle","h2","_c5","CaptureModalText","p","_c6","CaptureModalActions","_c7","CaptureModalColumn","_c8","CaptureButton","button","_c9","shuffleTurnsOrder","arr","concat","splice","availableColors","Game","map","_s","teams","setTeams","useState","basePositions","setBasePositions","gameState","setGameState","turnsOrder","setTurnsOrder","currentTurn","setCurrentTurn","roundNumber","setRoundNumber","activeTeam","setActiveTeam","pendingCaptureZone","setPendingCaptureZone","captureState","setCaptureState","attackerAnswered","defenderAnswered","attackerCorrect","defenderCorrect","firstResponder","setBase","useCallback","zoneId","teamIndex","newBasePositions","newTeams","base","toggleZoneToTeam","shouldCleanupBase","zones","includes","filter","z","prevOwner","find","team","console","log","push","onTurnComplete","nextTeam","slice","length","newTurnsOrder","undefined","i","onZoneClick","isRightClick","zoneOwner","zoneOwnerId","findIndex","score","cancelCapture","maybeResolveCapture","state","winner","forEach","zone","handleAttackerAnswer","isCorrect","prev","next","handleDefenderAnswer","attackerOrderLabel","defenderOrderLabel","children","disabledZones","getAdjucentZones","_","index","flatMap","fileName","_jsxFileName","lineNumber","columnNumber","onTeamAdded","teamName","name","color","pop","onTeamClick","onGameStart","tmp","className","onClick","_c0","$RefreshReg$"],"sources":["D:/siteauth/my-website — копия/src/components/game.js"],"sourcesContent":["import * as React from 'react';\r\nimport styled from 'styled-components';\r\nimport GameControls from './game-controls';\r\nimport Map from './map';\r\nimport { shuffleArray } from '../logic/utils';\r\n\r\nconst GameContainer = styled.div`\r\n  display: flex;\r\n  gap: 10px;\r\n  padding: 10px;\r\n\r\n  // height fix\r\n  height: calc(100% - 20px);\r\n`;\r\n\r\nconst CaptureModalBackdrop = styled.div`\r\n  position: fixed;\r\n  inset: 0;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n`;\r\n\r\nconst CaptureModalCard = styled.div`\r\n  background: #ffffff;\r\n  border-radius: 16px;\r\n  padding: 24px 24px 72px;\r\n  width: 95%;\r\n  max-width: 1100px;\r\n  height: 80vh;\r\n  box-shadow: 0 24px 80px rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  flex-direction: column;\r\n  position: relative;\r\n`;\r\n\r\nconst CaptureModalImagePlaceholder = styled.div`\r\n  width: 100%;\r\n  height: 80px;\r\n  border-radius: 8px;\r\n  background: #f2f2f2;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #777;\r\n  font-size: 14px;\r\n  margin-top: 8px;\r\n  margin-bottom: 16px;\r\n`;\r\n\r\nconst CaptureModalTitle = styled.h2`\r\n  margin: 0 0 8px;\r\n  font-size: 20px;\r\n`;\r\n\r\nconst CaptureModalText = styled.p`\r\n  margin: 12px 0 20px;\r\n  font-size: 14px;\r\n  color: #444;\r\n`;\r\n\r\nconst CaptureModalActions = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-end;\r\n  gap: 24px;\r\n  position: absolute;\r\n  left: 24px;\r\n  right: 24px;\r\n  bottom: 24px;\r\n`;\r\n\r\nconst CaptureModalColumn = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n`;\r\n\r\nconst CaptureButton = styled.button`\r\n  padding: 8px 16px;\r\n  border-radius: 8px;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n\r\n  &.cancel {\r\n    background: #e5e5e5;\r\n    color: #222;\r\n  }\r\n\r\n  &.confirm {\r\n    background: #16a34a;\r\n    color: #fff;\r\n  }\r\n\r\n  &.confirm-alt {\r\n    background: #22c55e;\r\n    color: #fff;\r\n  }\r\n\r\n  &.cancel-alt {\r\n    background: #f97316;\r\n    color: #fff;\r\n  }\r\n`;\r\n\r\nconst shuffleTurnsOrder = (arr) => arr.concat(arr.splice(0, 1));\r\n\r\nconst availableColors = shuffleArray([\r\n  '#7975b9',\r\n  '#007F73',\r\n  '#FB9AD1',\r\n  '#FFC470',\r\n  '#C5FF95',\r\n  '#4793AF',\r\n  '#ff7171',\r\n]);\r\n\r\nconst Game = ({ map }) => {\r\n  const [teams, setTeams] = React.useState([]);\r\n  const [basePositions, setBasePositions] = React.useState([]);\r\n  const [gameState, setGameState] = React.useState('prepare');\r\n  const [turnsOrder, setTurnsOrder] = React.useState([]);\r\n  const [currentTurn, setCurrentTurn] = React.useState(null);\r\n  const [roundNumber, setRoundNumber] = React.useState(0);\r\n  const [activeTeam, setActiveTeam] = React.useState(null);\r\n  const [pendingCaptureZone, setPendingCaptureZone] = React.useState(null);\r\n  const [captureState, setCaptureState] = React.useState({\r\n    attackerAnswered: false,\r\n    defenderAnswered: false,\r\n    attackerCorrect: null,\r\n    defenderCorrect: null,\r\n    firstResponder: null,\r\n  });\r\n\r\n  const setBase = React.useCallback(\r\n    (zoneId, teamIndex) => {\r\n      const newBasePositions = [...basePositions, zoneId];\r\n      const newTeams = [...teams];\r\n      newTeams[teamIndex].base = zoneId;\r\n\r\n      setBasePositions(newBasePositions);\r\n      setTeams(newTeams);\r\n    },\r\n    [basePositions, teams]\r\n  );\r\n\r\n  const toggleZoneToTeam = React.useCallback(\r\n    (zoneId, teamIndex) => {\r\n      let shouldCleanupBase = true;\r\n      const newTeams = [...teams];\r\n\r\n      if (teams[teamIndex].zones.includes(zoneId)) {\r\n        newTeams[teamIndex].zones = newTeams[teamIndex].zones.filter((z) => z !== zoneId);\r\n\r\n        if (newTeams[teamIndex].base === zoneId) {\r\n          newTeams[teamIndex].base = null;\r\n        }\r\n      } else {\r\n        // Remove the zone from the previous owner\r\n        const prevOwner = newTeams.find((team) => team.zones.includes(zoneId));\r\n        if (prevOwner) {\r\n          prevOwner.zones = prevOwner.zones.filter((z) => z !== zoneId);\r\n        }\r\n\r\n        // Set the base if preparing\r\n        if (gameState === 'prepare' && !newTeams[activeTeam].base) {\r\n          console.log('set base', zoneId);\r\n          setBase(zoneId, activeTeam);\r\n          shouldCleanupBase = false;\r\n        }\r\n\r\n        newTeams[teamIndex].zones.push(zoneId);\r\n      }\r\n\r\n      // Destroy the base\r\n      if (shouldCleanupBase) {\r\n        setBasePositions(basePositions.filter((z) => z !== zoneId));\r\n      }\r\n\r\n      setTeams(newTeams);\r\n    },\r\n    [activeTeam, basePositions, gameState, setBase, teams]\r\n  );\r\n\r\n  const onTurnComplete = React.useCallback(() => {\r\n    const nextTeam = turnsOrder\r\n      .slice(currentTurn + 1)\r\n      .find((teamIndex) => teams[teamIndex].zones.length > 0);\r\n\r\n    if (typeof nextTeam !== 'undefined') {\r\n      setCurrentTurn(currentTurn + 1);\r\n      setActiveTeam(nextTeam);\r\n      return;\r\n    }\r\n\r\n    setRoundNumber(roundNumber + 1);\r\n    setCurrentTurn(0);\r\n\r\n    const newTurnsOrder = shuffleTurnsOrder(\r\n      [...turnsOrder]\r\n        .map((teamIndex) => (teams[teamIndex].zones.length > 0 ? teamIndex : undefined))\r\n        .filter((i) => typeof i !== 'undefined')\r\n    );\r\n\r\n    setTurnsOrder(newTurnsOrder);\r\n    setActiveTeam(newTurnsOrder[0]);\r\n  }, [currentTurn, roundNumber, teams, turnsOrder]);\r\n\r\n  const onZoneClick = React.useCallback(\r\n    (zoneId, isRightClick) => {\r\n      if (gameState === 'prepare' && activeTeam !== null) {\r\n        toggleZoneToTeam(zoneId, activeTeam);\r\n      }\r\n      if (gameState === 'started') {\r\n        const zoneOwner = teams.find((team) => team.zones.includes(zoneId));\r\n        const zoneOwnerId = teams.findIndex((team) => team.zones.includes(zoneId));\r\n        const newTeams = [...teams];\r\n\r\n        if (isRightClick) {\r\n          if (!zoneOwner || zoneOwnerId === activeTeam) return;\r\n\r\n          if (zoneOwner && zoneOwner.base === zoneId && basePositions.includes(zoneId)) {\r\n            newTeams[zoneOwnerId].score += 200;\r\n          } else {\r\n            newTeams[zoneOwnerId].score += 100;\r\n          }\r\n          setTeams(newTeams);\r\n          onTurnComplete();\r\n        }\r\n        if (!isRightClick) {\r\n          // neutral tile: immediate capture as before\r\n          if (!zoneOwner) {\r\n            newTeams[activeTeam].score += 100;\r\n            toggleZoneToTeam(zoneId, activeTeam);\r\n            setTeams(newTeams);\r\n            onTurnComplete();\r\n            return;\r\n          }\r\n\r\n          // own tile: ignore\r\n          if (zoneOwnerId === activeTeam) {\r\n            return;\r\n          }\r\n\r\n          // enemy tile: open confirmation window\r\n          setPendingCaptureZone(zoneId);\r\n          setCaptureState({\r\n            attackerAnswered: false,\r\n            defenderAnswered: false,\r\n            attackerCorrect: null,\r\n            defenderCorrect: null,\r\n            firstResponder: null,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    [activeTeam, basePositions, gameState, onTurnComplete, teams, toggleZoneToTeam]\r\n  );\r\n\r\n  const cancelCapture = React.useCallback(() => {\r\n    setPendingCaptureZone(null);\r\n    setCaptureState({\r\n      attackerAnswered: false,\r\n      defenderAnswered: false,\r\n      attackerCorrect: null,\r\n      defenderCorrect: null,\r\n      firstResponder: null,\r\n    });\r\n  }, []);\r\n\r\n  const maybeResolveCapture = React.useCallback(\r\n    (state, zoneId) => {\r\n      if (!state.attackerAnswered || !state.defenderAnswered) return;\r\n\r\n      const zoneOwner = teams.find((team) => team.zones.includes(zoneId));\r\n      const zoneOwnerId = teams.findIndex((team) => team.zones.includes(zoneId));\r\n      if (!zoneOwner || zoneOwnerId === -1) {\r\n        // fallback: no defender, attacker wins on correct\r\n        return;\r\n      }\r\n\r\n      let winner = 'defender';\r\n\r\n      if (!state.attackerCorrect && !state.defenderCorrect) {\r\n        winner = 'defender';\r\n      } else if (state.attackerCorrect && !state.defenderCorrect) {\r\n        winner = 'attacker';\r\n      } else if (!state.attackerCorrect && state.defenderCorrect) {\r\n        winner = 'defender';\r\n      } else if (state.attackerCorrect && state.defenderCorrect) {\r\n        winner = state.firstResponder === 'attacker' ? 'attacker' : 'defender';\r\n      }\r\n\r\n      const newTeams = [...teams];\r\n\r\n      if (winner === 'attacker' && zoneOwnerId !== activeTeam) {\r\n        if (zoneOwner.base === zoneId && basePositions.includes(zoneId)) {\r\n          newTeams[activeTeam].score += 400;\r\n\r\n          newTeams[zoneOwnerId].zones.forEach((zone) => toggleZoneToTeam(zone, activeTeam));\r\n          newTeams[zoneOwnerId].base = null;\r\n          setBasePositions(basePositions.filter((z) => z !== zoneId));\r\n        } else {\r\n          newTeams[activeTeam].score += 100;\r\n          toggleZoneToTeam(zoneId, activeTeam);\r\n        }\r\n      }\r\n\r\n      setTeams(newTeams);\r\n      setPendingCaptureZone(null);\r\n      setCaptureState({\r\n        attackerAnswered: false,\r\n        defenderAnswered: false,\r\n        attackerCorrect: null,\r\n        defenderCorrect: null,\r\n        firstResponder: null,\r\n      });\r\n      onTurnComplete();\r\n    },\r\n    [activeTeam, basePositions, onTurnComplete, teams, toggleZoneToTeam]\r\n  );\r\n\r\n  const handleAttackerAnswer = React.useCallback(\r\n    (isCorrect) => {\r\n      if (!pendingCaptureZone) return;\r\n      setCaptureState((prev) => {\r\n        if (prev.attackerAnswered) return prev;\r\n        const next = {\r\n          ...prev,\r\n          attackerAnswered: true,\r\n          attackerCorrect: isCorrect,\r\n          firstResponder: prev.firstResponder || 'attacker',\r\n        };\r\n        maybeResolveCapture(next, pendingCaptureZone);\r\n        return next;\r\n      });\r\n    },\r\n    [maybeResolveCapture, pendingCaptureZone]\r\n  );\r\n\r\n  const handleDefenderAnswer = React.useCallback(\r\n    (isCorrect) => {\r\n      if (!pendingCaptureZone) return;\r\n      setCaptureState((prev) => {\r\n        if (prev.defenderAnswered) return prev;\r\n        const next = {\r\n          ...prev,\r\n          defenderAnswered: true,\r\n          defenderCorrect: isCorrect,\r\n          firstResponder: prev.firstResponder || 'defender',\r\n        };\r\n        maybeResolveCapture(next, pendingCaptureZone);\r\n        return next;\r\n      });\r\n    },\r\n    [maybeResolveCapture, pendingCaptureZone]\r\n  );\r\n\r\n  const attackerOrderLabel =\r\n    captureState.firstResponder === 'attacker'\r\n      ? '1'\r\n      : captureState.firstResponder === 'defender' && captureState.attackerAnswered\r\n      ? '2'\r\n      : '';\r\n\r\n  const defenderOrderLabel =\r\n    captureState.firstResponder === 'defender'\r\n      ? '1'\r\n      : captureState.firstResponder === 'attacker' && captureState.defenderAnswered\r\n      ? '2'\r\n      : '';\r\n\r\n  return (\r\n    <GameContainer>\r\n      <Map\r\n        teams={teams}\r\n        basePositions={basePositions}\r\n        gameState={gameState}\r\n        disabledZones={\r\n          gameState === 'prepare' && activeTeam !== null\r\n            ? map.getAdjucentZones(\r\n                teams.filter((_, index) => index !== activeTeam).flatMap((team) => team.zones)\r\n              )\r\n            : []\r\n        }\r\n        onZoneClick={onZoneClick}\r\n      />\r\n      <GameControls\r\n        teams={teams}\r\n        activeTeam={activeTeam}\r\n        onTeamAdded={(teamName) => {\r\n          setTeams([\r\n            ...teams,\r\n            {\r\n              name: teamName,\r\n              score: 1000,\r\n              zones: [],\r\n              color: availableColors.pop(),\r\n            },\r\n          ]);\r\n        }}\r\n        onTeamClick={(teamIndex) => {\r\n          if (gameState === 'prepare') {\r\n            setActiveTeam(teamIndex === activeTeam ? null : teamIndex);\r\n          }\r\n        }}\r\n        onGameStart={() => {\r\n          setGameState('started');\r\n          setCurrentTurn(0);\r\n          setRoundNumber(1);\r\n          setTurnsOrder(teams.map((tmp, index) => index));\r\n          setActiveTeam(0);\r\n        }}\r\n        onTurnComplete={onTurnComplete}\r\n        gameState={gameState}\r\n        currentTurn={turnsOrder[currentTurn]}\r\n        roundNumber={roundNumber}\r\n      />\r\n      {pendingCaptureZone && (\r\n        <CaptureModalBackdrop>\r\n          <CaptureModalCard>\r\n            <CaptureModalImagePlaceholder>\r\n              Image placeholder\r\n            </CaptureModalImagePlaceholder>\r\n            <CaptureModalTitle>Захватить зону {pendingCaptureZone}?</CaptureModalTitle>\r\n            <CaptureModalText>\r\n              Здесь будет описание задания или подсказка для игрока. После выполнения\r\n              задания выберите результат атаки для атакующих и защищающихся.\r\n            </CaptureModalText>\r\n            <CaptureModalActions>\r\n              <CaptureModalColumn>\r\n                <span>{attackerOrderLabel}</span>\r\n                <CaptureButton className=\"confirm\" onClick={() => handleAttackerAnswer(true)}>\r\n                  Атакующие-верно\r\n                </CaptureButton>\r\n                <CaptureButton className=\"cancel\" onClick={() => handleAttackerAnswer(false)}>\r\n                  Актакующие-неверно\r\n                </CaptureButton>\r\n              </CaptureModalColumn>\r\n              <CaptureModalColumn>\r\n                <span>{defenderOrderLabel}</span>\r\n                <CaptureButton\r\n                  className=\"confirm-alt\"\r\n                  onClick={() => handleDefenderAnswer(true)}\r\n                >\r\n                  Защищающиеся - верно\r\n                </CaptureButton>\r\n                <CaptureButton\r\n                  className=\"cancel-alt\"\r\n                  onClick={() => handleDefenderAnswer(false)}\r\n                >\r\n                  Защищающиеся- неверно\r\n                </CaptureButton>\r\n              </CaptureModalColumn>\r\n            </CaptureModalActions>\r\n          </CaptureModalCard>\r\n        </CaptureModalBackdrop>\r\n      )}\r\n    </GameContainer>\r\n  );\r\n};\r\n\r\nexport default Game;\r\n\r\n\r\n"],"mappings":";;AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,OAAOC,MAAM,MAAM,mBAAmB;AACtC,OAAOC,YAAY,MAAM,iBAAiB;AAC1C,OAAOC,GAAG,MAAM,OAAO;AACvB,SAASC,YAAY,QAAQ,gBAAgB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE9C,MAAMC,aAAa,GAAGN,MAAM,CAACO,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,EAAA,GAPIF,aAAa;AASnB,MAAMG,oBAAoB,GAAGT,MAAM,CAACO,GAAG;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACG,GAAA,GARID,oBAAoB;AAU1B,MAAME,gBAAgB,GAAGX,MAAM,CAACO,GAAG;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACK,GAAA,GAXID,gBAAgB;AAatB,MAAME,4BAA4B,GAAGb,MAAM,CAACO,GAAG;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACO,GAAA,GAZID,4BAA4B;AAclC,MAAME,iBAAiB,GAAGf,MAAM,CAACgB,EAAE;AACnC;AACA;AACA,CAAC;AAACC,GAAA,GAHIF,iBAAiB;AAKvB,MAAMG,gBAAgB,GAAGlB,MAAM,CAACmB,CAAC;AACjC;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAJIF,gBAAgB;AAMtB,MAAMG,mBAAmB,GAAGrB,MAAM,CAACO,GAAG;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACe,GAAA,GATID,mBAAmB;AAWzB,MAAME,kBAAkB,GAAGvB,MAAM,CAACO,GAAG;AACrC;AACA;AACA;AACA,CAAC;AAACiB,GAAA,GAJID,kBAAkB;AAMxB,MAAME,aAAa,GAAGzB,MAAM,CAAC0B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}